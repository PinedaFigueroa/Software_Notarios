<!-- archivo: app/superadmin/templates/superadmin/bufetes/listar_bufetes.html -->
{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center">
    <h2>Bufetes</h2>
    <a href="{{ url_for('superadmin_bp.crear_bufete') }}"
       class="btn btn-primary"
       title="Crear un nuevo bufete en el sistema">+ Nuevo Bufete</a>
  </div>

  <form class="mt-3 mb-3" method="get">
    <div class="input-group">
      <input type="text" class="form-control" name="q" placeholder="Buscar por nombre..." value="{{ q or '' }}" title="Escribe el nombre del bufete">
      <button class="btn btn-outline-secondary" type="submit" title="Filtrar listado">Buscar</button>
    </div>
  </form>

  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Plan</th>
        <th>Activo</th>
        <th class="text-end">Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for b in bufetes %}
      <tr>
        <td>{{ b.id }}</td>
        <td>{{ b.nombre_bufete }}</td>
        <td>{{ b.plan.nombre if b.plan else '-' }}</td>
        <td>
          {% if b.activo %}
          <span class="badge bg-success">SÃ­</span>
          {% else %}
          <span class="badge bg-secondary">No</span>
          {% endif %}
        </td>
        <td class="text-end">
          <a class="btn btn-sm btn-outline-primary"
             href="{{ url_for('superadmin_bp.editar_bufete', bufete_id=b.id) }}"
             title="Editar datos del bufete">Editar</a>
          <form action="{{ url_for('superadmin_bp.toggle_estado_bufete', bufete_id=b.id) }}"
                method="post" style="display:inline-block">
            <button class="btn btn-sm btn-outline-warning" type="submit"
                    title="{{ 'Desactivar' if b.activo else 'Activar' }} bufete">
              {{ 'Desactivar' if b.activo else 'Activar' }}
            </button>
          </form>
          <a class="btn btn-sm btn-outline-dark"
             href="{{ url_for('superadmin_bp.listar_usuarios', bufete_id=b.id) }}"
             title="Ver usuarios pertenecientes a este bufete">Usuarios</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
